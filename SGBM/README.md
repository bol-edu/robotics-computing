## Stereo Matching
SGBM 演算法是一種用於立體視覺和深度估計的演算法，它可以在左右相機圖像之間進行視差計算SGBM 是「Semi-Global Block Matching」的縮寫，是一種基於區塊匹配的演算法，用於計算左右相機圖像之間的位移（視差）。SGBM 演算法使用窗口匹配的方法，在左右圖像中匹配特定大小的區塊。它計算每個區塊在另一個圖像中的對應區塊的相似度，以確定每個像素的視差值。它通過考慮每個像素的整個代價（cost）圖，並將其與經過平滑處理的代價圖進行比較，以選擇最佳匹配。SGBM 演算法使用多種技術，例如雙向匹配、多尺度策略和代價聚合，以提高深度估計的精度和可靠性。儘管 SGBM 演算法可以獲得較高的準確性和鮮明度，但它需要較高的計算成本和記憶體使用，並且對於圖像中存在重複紋理區域的情況下可能會產生不準確的估計。
![](https://i.imgur.com/YB4czKv.png)

- ### 輸入/輸出
    輸入 : 將左右兩張圖片以及相機的 k、t、r 參數讀進來
    輸出 : 經過計算後輸出深度
- ### matching cost computation (匹配代價計算)預處理
    1. 輸入圖像經過SobelX處理后，計算BT代價。
    2. 輸入圖像直接計算BT代價值。
    3. 將上面兩步的代價值進行融合。
    4. 對上述步驟得到的代價值進行成塊處理，在SGBM演算法中，成塊計算就是就是對每個圖元的代價值用周圍鄰域代價值的總和來代替。
- ### cost aggregation (代價聚合) 
![](https://i.imgur.com/GsnBGvV.png)
![](https://i.imgur.com/evrtMXA.png =40%x)
![](https://i.imgur.com/GeZZkEz.png =80%x)

L為當前路徑累積的代價函數，P1、P2為圖元點與相鄰點視差存在較小和較大差異情況下的平滑懲罰(P1<P2)，第三項是為了消除各個方向路徑長度不同造成的影響。將所有r方向的匹配代價相加得到總的匹配代價(代價聚合)。
- ### disparity computation/optimization (視差計算或優化)
    1. sgbm演算法中關於視差的選擇，一般是直接選擇使得聚合代價最小的視差。
    2. 每個像素的視差選擇都只是簡單通過WTA（Winner Takes All）決定的。
- ### disparity refinement (視差改良)後處理
